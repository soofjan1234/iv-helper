# 面试复盘报告

> 日期: 2026-02-03 11:00
> 题目数量: 20 道（重点复习 7 + 常规 5 + 新题 8）
> 双维度评分: 知识正确度 + 表达结构 => 综合等级

---

## 总体概览

- **综合得分**: 3.4/5.0（约 6.8/10）
- **评分分布**: A(8) B(7) C(2) D(3)
- **亮点**: 三道 D 题（NAT、Topic/Channel、幂等性）明显进步；并发事务、ACID、切片扩容、Redis 类型、Bleve、DBSCAN 表现稳定。
- **待攻坚**: MVCC 未作答、进程/线程/协程与人脸流程过简、MySQL 执行流程第五步仍错、B+ 树未收尾。

---

## 逐题精批

### 第 1 题: NAT 类型有哪些？哪种类型最容易打洞？

**评分**: 知识 4.0 | 表达 3.5 => **B (3.75)**

**你的回答**:
> 全锥形、受限锥形（易打洞），端口受限锥形（需相同 IP 和端口），对称型（每请求新 IP:Port，难打洞，靠中继）。自述对「哪边 IP 可访问」前后关系还不清楚。

**分析**:
- ✅ 四种类型都说了，打洞难度排序正确。
- ✅ 对称型中继说对了。
- ❌ 「前置/后置对象」：是**内网设备 A 的 NAT 规则**——只放行「A 曾发过请求的对方 IP（或 IP:Port）」的回包。

**复习计划**: 2026-02-05

---

### 第 2 题: Topic 和 Channel 的关系？消息如何分发？

**评分**: 知识 5.0 | 表达 4.0 => **A (4.5)**

**你的回答**:
> Topic 对 Channel 是广播，每条消息发到各 Channel；Channel 再选消费者。举例：订单系统一个订单通知多个 Channel（打包、发货），大促时负载均衡给消费者。

**分析**:
- ✅ **广播关系说对了**，上次 D 已纠正。
- ✅ 订单 + 多 Channel 举例到位。
- 💡 可补一句：同一 Channel 下多消费者才是负载均衡，Channel 之间不是竞争而是各拿全量。

**复习计划**: 2026-02-05

---

### 第 3 题: 什么是幂等性？如何保证消费幂等？

**评分**: 知识 4.5 | 表达 4.0 => **A (4.25)**

**你的回答**:
> 做多次结果和做一次一样。NSQ：消息加 UUID、查表防重复，或投到天然幂等的存储（MySQL、Redis、SQLite）。

**分析**:
- ✅ 定义正确。
- ✅ 手段完整：业务 ID + 去重表、天然幂等存储。
- 上次 D 已扳回。

**复习计划**: 2026-02-05

---

### 第 4 题: 什么是内存逃逸？

**评分**: 知识 4.0 | 表达 3.5 => **B (3.75)**

**你的回答**:
> 变量生命周期超出栈范围，被分配到堆上，由 GC 回收，会占性能。

**分析**:
- ✅ 定义正确，未再出现「没被回收」的误区。
- ✅ 提到堆与 GC、性能影响。
- 💡 可补：逃逸到堆的仍会被 GC 回收，只是分配/回收成本比栈大。

**复习计划**: 2026-02-06

---

### 第 5 题: MySQL 执行流程是怎样的？

**评分**: 知识 3.0 | 表达 3.5 => **C (3.25)**

**你的回答**:
> 连接器(身份) → 查询缓存(8.0 取消) → 词法分析 → 优化 → **查询** → 存储引擎。

**分析**:
- ❌ 第五步应是 **「执行器」**（执行语句、返回结果），不是「查询」。
- 记忆口诀：**连-缓-分-优-执-存**。

**复习计划**: 2026-02-05

---

### 第 6 题: 并发事务会有哪些问题？

**评分**: 知识 5.0 | 表达 4.0 => **A (4.5)**

**你的回答**:
> 脏读（读到未提交后又被回滚）、不可重复读（同事务两次读不同）、幻读（两次读行数变化）、丢失修改（两事务同改，后者覆盖前者）。

**分析**:
- ✅ 四个问题都到齐，定义清晰。
- 上次 C 已巩固。

**复习计划**: 2026-02-07

---

### 第 7 题: 混合加密的具体流程？

**评分**: 知识 4.5 | 表达 3.5 => **B (4.0)**

**你的回答**:
> 发送方：对称加密数据，用非对称加密 key；接收方：用非对称私钥解密 key，再用 key 解密数据。

**分析**:
- ✅ 流程正确，公私钥角色对（解密用私钥）。
- 💡 表达可更简：先「对称加密数据」，再「用对方公钥加密对称 key」；对方「私钥解出 key → 再解数据」。

**复习计划**: 2026-02-06

---

### 第 8 题: ACID 特性是什么？分别如何实现？

**评分**: 知识 4.5 | 表达 4.0 => **A (4.25)**

**你的回答**:
> A 原子性（Undo Log）、C 一致性（靠其余三者）、I 隔离性（锁+MVCC）、D 持久性（Redo Log）。自述持久性那句有点不顺。

**分析**:
- ✅ 四项与实现方式都对。
- 💡 持久性可改成：「提交后变更永久落盘，由 Redo Log 保证。」

**复习计划**: 2026-02-09

---

### 第 9 题: MVCC 是什么？如何实现？

**评分**: 知识 1.0 | 表达 1.0 => **D (1.0)**

**你的回答**:
> 已经熟记于心 改为2-9号复习

**分析**:
- ❌ 未在卷面作答，按未答处理；若已熟记，下次可直接口述要点（Undo Log 多版本 + ReadView 可见性）。

**复习计划**: 2026-02-04

---

### 第 10 题: 切片如何扩容？何时触发？

**评分**: 知识 4.5 | 表达 4.0 => **A (4.25)**

**你的回答**:
> 长度 ≥ 容量时扩容；<256 双倍，≥256 平滑 1.25 倍。

**分析**:
- ✅ 触发条件与规则正确。

**复习计划**: 2026-02-05

---

### 第 11 题: Redis 基本数据类型及场景？

**评分**: 知识 4.5 | 表达 4.0 => **A (4.25)**

**你的回答**:
> String(验证码)、Hash(对象)、List(消息/动态)、Set(共同好友)、ZSet(排行榜)、HyperLogLog(大规模去重)、Stream(消息队列)。

**分析**:
- ✅ 七种 + 场景都对，HyperLogLog 用途已纠正。

**复习计划**: 2026-02-07

---

### 第 12 题: 为什么 goroutine 比线程轻量？

**评分**: 知识 3.5 | 表达 3.5 => **B (3.5)**

**你的回答**:
> 初始占几 KB、用户态不涉及系统调用、GMP 优化、可成千上万协程 vs 系统几百几千线程。

**分析**:
- ✅ 四点都提到。
- ❌ 线程栈是 **1～8MB**，不是「几十 MB」。

**复习计划**: 2026-02-05

---

### 第 13 题: 为什么不选 ES/Meilisearch 而选 Bleve？

**评分**: 知识 4.5 | 表达 4.0 => **A (4.25)**

**你的回答**:
> ES 分布式/偏重、JVM 1–2GB；Meilisearch 也占内存；Bleve Go 原生、嵌入式、像 SQLite、无需额外服务。

**分析**:
- ✅ 选型理由清晰，和文档中心 Notion 一致。

**复习计划**: 2026-02-05

---

### 第 14 题: 人脸检测和识别的流程？

**评分**: 知识 2.5 | 表达 2.0 => **D (2.25)**

**你的回答**:
> OpenCV 检测人脸 → 提取向量特征 → 「接着你再用」未说完。

**分析**:
- ❌ 未完成：检测 → 特征提取 → **聚类(如 DBSCAN)** → **新图与聚类中心距离判定/归类**。
- 建议补全「识别」阶段：特征向量 → 聚类/比对 → 分类结果。

**复习计划**: 2026-02-04

---

### 第 15 题: DBSCAN 算法是什么？如何工作？

**评分**: 知识 4.5 | 表达 4.5 => **A (4.5)**

**你的回答**:
> 社交范围(eps)、小弟数(MinPts)；大佬/边界/孤立点；任选点 P，邻域够则标大佬并扩圈，否则孤立。

**分析**:
- ✅ 比喻贴切，流程正确，无需改。

**复习计划**: 2026-02-05

---

### 第 16 题: 还了解过什么设计模式？项目里用过哪些？

**评分**: 知识 4.0 | 表达 3.5 => **B (3.75)**

**你的回答**:
> 单例（全局连接器等）、责任链（鉴权、限流等）。

**分析**:
- ✅ 举例清楚。
- 💡 可补：观察者、享元、策略（相册部署模式）等，与项目对应。

**复习计划**: 2026-02-05

---

### 第 17 题: 进程、线程、协程的区别？

**评分**: 知识 1.0 | 表达 1.0 => **D (1.0)**

**你的回答**:
> 开销越来越小。

**分析**:
- ❌ 过于简略。建议至少说：进程=资源分配单位/独立内存，线程=进程内执行单位/共享内存，协程=用户态轻量调度/Go 的 goroutine；开销与调度层级不同。

**复习计划**: 2026-02-04

---

### 第 18 题: 什么是闭包？特性和使用场景？

**评分**: 知识 4.0 | 表达 3.5 => **B (3.75)**

**你的回答**:
> 匿名函数 + 变量上下文；封装、私有化、隐藏实现。

**分析**:
- ✅ 定义和用途都对。
- 💡 可补：闭包会捕获外部变量且生命周期延长、非并发安全。

**复习计划**: 2026-02-05

---

### 第 19 题: 什么是缓存击穿？如何解决？

**评分**: 知识 4.0 | 表达 3.5 => **B (3.75)**

**你的回答**:
> 热点 key 集体失效，请求打到 DB；永不过期或预热。

**分析**:
- ✅ 击穿定义和两种手段都对。
- 💡 可补：互斥锁（只有一个请求回源）、逻辑过期（物理永不过期，异步更新）。

**复习计划**: 2026-02-05

---

### 第 20 题: 为什么用 B+ 树而不是其他数据结构？

**评分**: 知识 3.0 | 表达 3.0 => **C (3.0)**

**你的回答**:
> Hash 不支持范围；二叉树会退化；红黑树为平衡操作频繁。

**分析**:
- ✅ 反面都说到了。
- ❌ 未收尾 **B+ 树**：叶子有序链表适合范围与排序、多路降低高度、非叶只存 key 提高扇出。

**复习计划**: 2026-02-05

---

## 复习统计

| 等级 | 数量 | 题号 |
|------|------|------|
| A | 8 | 2, 3, 6, 8, 10, 11, 13, 15 |
| B | 7 | 1, 4, 7, 12, 16, 18, 19 |
| C | 2 | 5, 20 |
| D | 3 | 9, 14, 17 |

---

## 追问小结（你已写回 test.md）

1. **受限锥形**：只接受「A 曾发过请求的 IP」的回包，所以 S 可回、未访问过的 B 不能乱入。
2. **打洞本质**：是让 NAT 认为入站包是「之前某次出站请求的合法响应」。
3. **缓存一致**：先删缓存再更新 DB 易产生脏读窗口；先更新 DB 再删缓存更稳，配合重试/ Canal 等可进一步保证一致性。

---

## 提升建议

### 要点速记
- **MySQL 执行流程**：第五步是「**执行器**」，口诀：连-缓-分-优-执-存。
- **MVCC**：Undo Log 多版本 + ReadView 可见性，需能口述完整。
- **goroutine 轻量**：线程栈 1～8MB（非「几十 MB」）；B+ 树收尾要说到叶子链表、多路、范围查询。

### 本次待巩固题目（直接列出原题，便于下次按题突破）
1. NAT 类型有哪些？哪种类型最容易打洞？
2. 为什么此时服务器 S 能发回数据，而另一个未被 A 访问过的公网 IP 地址 B 却无法通过这个「洞」向 A 发送数据？
3. 所谓「打洞」成功，核心是让 NAT 设备认为接下来的外部入站包是「合法的响应」吗？
4. 为什么不选 ES 或 Meilisearch 而是 Bleve？
5. 人脸检测和识别的流程是怎样的？
6. 进程、线程、协程的区别是什么？
7. 为什么用 B+ 树而不是其他数据结构？
8. 在高并发且数据频繁更新的业务场景下，如果缓存永不失效，你将采取什么策略来保证数据库（DB）与缓存（Cache）之间的数据一致性？

---

## 已更新复习计划

- D 题（9/14/17）：2026-02-04
- C 题（5/20）及部分 B：2026-02-05
- 其余 B/A：2026-02-05 ～ 2026-02-09
